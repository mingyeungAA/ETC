<h1>🍞ORM(Obejct Relational Mapping)</h1>

<h2>영속성</h2>

데이터를 생성한 프로그램이 종료되더라도 사라지지 않는 데이터의 특성을 말한다.\

영속성을 갖지 않는 데이터는 단지 메모리에서만 존재하기 때문에 프로그램을 종료하면 모두 잃어버라게 된다.

- Object Persistence(영구적인 객체)
  - 메모리 상의 데이터를 파일 시스템, 관계형 데이터베이스 혹은 객체 데이터베이스 등을 활용하여 영구적으로 저장하여 영속성을 부여한다.
  - 데이터를 데이터베이스에 저장하는 3가지 방법
    - JDBC(java에서 사용)
    - Spring JDBC(ex.JdbcTemplate)
    - Persistence Framework(ex.Hibernate, Mybatis 등)
  - Persistence Layer
    - 프로그램의 아키텍쳐에서 데이터에 영속성을 부여해주는 계층을 말한다.
    - JDBC를 이용하여 직접 구현할 수 있지만 Persistence Framework를 이용한 개발이 많이 이루어진다.
  - Persistence Framework
    - JDBC프로그래미으이 복잡함이나 번거로움없이 간단한 작업만으로 데이터베이스와 연동되는 시스템을 빠르게 개발할 수 있으며 안정적인 구동을 보장한다.
    - Persistence Framework는 SQL Mapper와 ORM으로 나눌 수 있다.

<br>

<h2>🍰ORM이란</h2>

객체-관계 매핑

- 객체와 관계형 데이터베이스의 데이터를 자동으로 매핑해주는 것
  - 객체 지향 프로그래밍은 클래스를 사용하고, 관계형 데이터베이스는 테이블을 사용한다.
  - 객체 모델과 관계형 모델간에 불일치가 존재한다.
  - ORM을 통해 객체간의 관계를 바타응로 SQL을 자동으로 생성ㅎ여 불일치를 해결한다.
- 데이터베이스 데이터 <- 매팡 -> Object 필드
  - 객체를 통해 간접적으로 데이터베이스 데이터를 다룬다.

<br>

<h2>🍰ORM 장단점</h2>

<h3>장점</h3>

- 객체 지향적인 코드로 인해 더 직관적이고 비즈니스 로직에 더 집중할 수 있게 도와준다.
  - ORM을 이용하면 SQL Query가 아닌 직관적인 코드(메서드)로 데이터를 조작할 수 있어 개발자가 객체 모델로 프로그래밍하는데 집중할 수 있도록 도와준다.
  - 선언문, 할당,종료같은 부수적인 코드가 없거나 급격히 줄어든다.
  - 각종 객체에 대한 코드를 별도로 작성하기 때문에 코드의 가독성을 올려준다.
  - SQL의 절차적이고 순차적인 접근이 아닌 객체 지향적인 접근으로 인해 생산성이 증가한다.
- 재사용 및 유지보수의 편리성이 증가한다.
  - ORM은 독립적으로 작성되어 있고, 해당 객체들을 재활용할 수 있다.
  - 때문에 모델에서 가공된 데이터를 컨트롤러에 의해 뷰와 합쳐지는 형태로 디자인패턴을 견고하게 다지는데 유리하다.
  - 매핑정보가 명확하여, ERD를 보는겟에 대한 의존도를 낮출 수 있다.
- DBMS에 대한 종속성이 줄어든다.
  - 객체간의 관계를 바탕으로 SQL을 자동으로 생성하기 때문에 RDBMS의 데이터구조와 JAVA의 객체지향 모델 사이의 간격을 좁힐 수 있다.
  - 대부분 ORM 솔루션은 DB에 종속적이지 않다.
  - 종속적이지 않다는 것은 구현 방법 뿐만 아니라 많은 솔루션에서 자료형 타입까지 유효하다.
  - 프로그래머는 Object에 집중함으로 극단적으로 DBMS를 교체하는 거대한 작업에도 비교적 적은 리스크와 시간이 소요된다.
  - 또한 자바에서 가공할 경우 equals, hashCode의 오버라이드 같은 자바의 기능을 이용할 수 있고, 간결하고 빠른 가공이 가능하다.

<h3>단점</h3>

- 완벽한 ORM으로만 서비스를 구현하기 어렵다.
  - 사용하기는 편하지만 설계는 맷우 신중하게 해야한다.
  - 프로젝트의 복잡성이 커질경우 난이도 또한 올라갈 수 있다.
  - 잘못 구현된 경우에 속도 저하 및 심각할 경우 일관성이 무너지는 문제점이 생길 수 있다.
  - 일부 자주 사용되는 대형 쿼리는 속도를 위해 SP를 쓰는 등 별도의 튜닝이 필요한 경우가 있다.
  - DBMS의 고유기능을 이용하기 어렵다.(특정 DBMS의 고유기능을 이용하면 이식성이 저하된다.)
  - 프로시저가 많은 시스템에선 ORM의 객체 지향적인 장점을 활용하기 어렵다.
    - 이미 프로시저가 많은 시스템에선 다시 객체로 바꿔야하며, 그과정에서 생산성 저하나 리스크가 많이 발생할 수 있다.

<br>

<h2>🍰객체-관계 간의 불일치</h2>

![img](https://gmlwjd9405.github.io/images/database/orm-impedance-mismatch.png)

<h3>세분성 Inheritance</h3>

RDBMS는 객체지향 프로그래밍 언어의 특징인 상속 개념이 없다.

<h3>일치 Identity</h3>

RBBMS는 sameness라는 하나의 개념을 정확히 정의하는데, 바로 기본키(Primary key)를 이용하여 동일성을 정의한다. 그러나 자바는 객체 식별(a==b)과 객체 동일성(a.equals(b))을 모두 정의한다.

즉, RDBMS에서는 PK가 같으면 서로 동일한 record로 정의하지만, java에서는 주소값이 같거나 내용이 같은 경우를 구분해서 정의한다.

<h3>연관성 Associations</h3>

객체지향 언어는 객체 참조를 사용하는 연관성을 나타내는 반면, RDBMS는 연관성을 외래키로 나타낸다.

<h3>탐색 Navigation</h3>

자바와 RDBMS에서 객체를 접근하는 방법이 근본적으로 다르다.

자바는 그래프 형태로 하나의 연결에서 다른 연결로 이동하며 탐색한다.

<br>

<h2>🍰Frameworks</h2>

<h3>JPA/Hibernate</h3>

JPA(Java Persistence API)는 자바의 ORM기술 표준으로 인터페이스의 모음이다. 이러한 JPA 표준 명세를 구현한 구현체가 바로 Hibernate이다.

<br>

<h3>Sequelize</h3>

Sequelize는 Postgres, MySQL, MariaDB, SQLite 등을 지원하는 Promise에 기반한 비동기로 동작하는 Node.js ORM이다. 

<br>

<h3>Django ORM</h3>

python기반 프레임워크인 Django에서 자체적으로 지원하는 ORM이다.



<br>

---

참고

- https://gmlwjd9405.github.io/2019/02/01/orm.html

